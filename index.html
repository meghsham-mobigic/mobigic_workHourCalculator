<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Time Calculator</title>
  <style>
    :root {
      --bg-color: #1e1e1e;
      --text-color: #fff;
      --input-bg: #333;
      --input-border: #666;
      --valid-border: #4caf50;
      --invalid-border: #f44336;
    }

    body.light {
      --bg-color: #f4f4f4;
      --text-color: #000;
      --input-bg: #fff;
      --input-border: #ccc;
    }

    body {
      background-color: var(--bg-color);
      color: var(--text-color);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      transition: background-color 0.3s ease, color 0.3s ease;
    }

    .container {
      background-color: var(--input-bg);
      padding: 2rem;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      max-width: 90%;
      width: 400px;
    }

    h2 {
      margin-bottom: 20px;
      text-align: center;
      font-size: 1.5rem;
    }

    .row {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 1rem;
    }

    input {
      flex: 1;
      padding: 0.8rem;
      font-size: 1rem;
      border: 2px solid var(--input-border);
      border-radius: 6px;
      background-color: var(--bg-color);
      color: var(--text-color);
    }

    input.valid {
      border-color: var(--valid-border);
    }

    input.invalid {
      border-color: var(--invalid-border);
    }
    
    .row.center {
  justify-content: center;
}
    
    

    .toggle {
      padding: 0.6rem 1rem;
      font-weight: bold;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      background-color: #555;
      color: white;
      min-width: 70px;
      text-align: center;
    }

    .toggle.am-toggle { background-color: #777; }
    .toggle.in-toggle.active { background-color: #ffc107; color: black; }
    .toggle.out-toggle.active { background-color: #2196f3; }

    .output {
      margin-top: 1.2rem;
      font-weight: bold;
      font-size: 1.2rem;
      text-align: center;
      min-height: 1.5rem;
    }

    .top-row {
      display: flex;
      justify-content: flex-end;
      margin-bottom: 1rem;
    }

    #themeToggle {
      font-size: 1.2rem;
      background: transparent;
      border: none;
      cursor: pointer;
      color: var(--text-color);
    }

    @media (max-width: 480px) {
      .container {
        padding: 1.2rem;
      }

      .toggle {
        padding: 0.5rem 0.8rem;
        font-size: 0.9rem;
        min-width: 60px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="top-row">
      <button id="themeToggle">ðŸŒž</button>
    </div>
    <h2>Time Calculator</h2>
    <div class="row">
      <input type="text" id="timeInput" placeholder="hh:mm" />
      <button id="ampmToggle" class="toggle am-toggle">AM</button>
    </div>
<div class="row center">
  <button id="inoutToggle" class="toggle in-toggle active">IN Time</button>
</div>

    <div class="output" id="result"></div>
  </div>

  <script>
    const timeInput = document.getElementById('timeInput');
    const ampmToggle = document.getElementById('ampmToggle');
    const inoutToggle = document.getElementById('inoutToggle');
    const resultDiv = document.getElementById('result');
    const themeToggle = document.getElementById('themeToggle');

    let isAM = true;
    let isInputIN = true;

    function formatTo12Hour(date) {
      let hours = date.getHours();
      let minutes = date.getMinutes();
      const ampm = hours >= 12 ? 'PM' : 'AM';
      hours = hours % 12 || 12;
      minutes = String(minutes).padStart(2, '0');
      return `${hours}:${minutes} ${ampm}`;
    }

    function parseTimeInput(timeStr) {
      const match = /^(\d{1,2}):(\d{2})$/.exec(timeStr.trim());
      if (!match) return null;

      let hours = parseInt(match[1], 10);
      let minutes = parseInt(match[2], 10);
      if (isNaN(hours) || isNaN(minutes) || minutes > 59 || hours > 23) return null;

      // Handle 12-hour input
      if (hours <= 12 && timeStr.length <= 5) {
        if (!isAM && hours !== 12) hours += 12;
        if (isAM && hours === 12) hours = 0;
      }

      return { hours, minutes };
    }

    function calculateTime() {
      const parsed = parseTimeInput(timeInput.value);

      if (!parsed) {
        timeInput.classList.remove('valid');
        timeInput.classList.add('invalid');
        resultDiv.textContent = '';
        return;
      }

      timeInput.classList.remove('invalid');
      timeInput.classList.add('valid');

      const baseDate = new Date();
      baseDate.setHours(parsed.hours);
      baseDate.setMinutes(parsed.minutes);
      baseDate.setSeconds(0);

      const delta = 9 * 60 + 30;
      const calculatedDate = new Date(baseDate);

      if (isInputIN) {
        calculatedDate.setMinutes(calculatedDate.getMinutes() + delta);
      } else {
        calculatedDate.setMinutes(calculatedDate.getMinutes() - delta);
      }

      const label = isInputIN
        ? `Calculated OUT Time`
        : `Calculated IN Time`;
      resultDiv.textContent = `${label}: ${formatTo12Hour(calculatedDate)}`;
    }

    function setDefaultTime() {
      const now = new Date();
      const hr = String(now.getHours()).padStart(2, '0');
      const min = String(now.getMinutes()).padStart(2, '0');
      timeInput.value = `${hr}:${min}`;
      isAM = now.getHours() < 12;
      ampmToggle.textContent = isAM ? 'AM' : 'PM';
      calculateTime();
    }

    timeInput.addEventListener('input', (e) => {
      let value = e.target.value.replace(/[^\d]/g, '');
      if (value.length >= 3) {
        value = value.slice(0, 2) + ':' + value.slice(2, 4);
      }
      e.target.value = value;
      calculateTime();
    });

    ampmToggle.addEventListener('click', () => {
      isAM = !isAM;
      ampmToggle.textContent = isAM ? 'AM' : 'PM';
      calculateTime();
    });

    inoutToggle.addEventListener('click', () => {
      isInputIN = !isInputIN;
      inoutToggle.textContent = isInputIN ? 'IN Time' : 'OUT Time';
      inoutToggle.classList.toggle('in-toggle', isInputIN);
      inoutToggle.classList.toggle('out-toggle', !isInputIN);
      inoutToggle.classList.toggle('active');
      calculateTime();
    });

    themeToggle.addEventListener('click', () => {
      const body = document.body;
      body.classList.toggle('light');
      const isLight = body.classList.contains('light');
      themeToggle.textContent = isLight ? 'ðŸŒ™' : 'ðŸŒž';
      localStorage.setItem('theme', isLight ? 'light' : 'dark');
    });

    function loadTheme() {
      const saved = localStorage.getItem('theme');
      const body = document.body;
      if (saved === 'light') {
        body.classList.add('light');
        themeToggle.textContent = 'ðŸŒ™';
      } else {
        body.classList.remove('light');
        themeToggle.textContent = 'ðŸŒž';
      }
    }

    window.onload = () => {
      loadTheme();
      setDefaultTime();
    };
  </script>
</body>
</html>
